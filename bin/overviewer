#!/bin/bash

OVERVIEWER_SCRIPT=$(readlink -f "$0")

WORLD_NAME=burpcraft
VERSION_MINECRAFT=1.16.2

PATH_OVERVIEWER_SCRIPT=$(dirname "$OVERVIEWER_SCRIPT")
PATH_OVERVIEWER_ROOT="${PATH_OVERVIEWER_SCRIPT%/bin}"
PATH_OVERVIEWER_WORLDS="${PATH_OVERVIEWER_ROOT}/worlds"

# probably different...
PATH_OVERVIEWER_EXEC="${PATH_OVERVIEWER_SCRIPT}/linux/overviewer/overviewer.py"

PATH_OVERVIEWER_WORLD="${PATH_OVERVIEWER_WORLDS}/${WORLD_NAME}"
PATH_OVERVIEWER_OUTPUT="${PATH_OVERVIEWER_ROOT}/dist/${WORLD_NAME}"

echo Minecraft:    ${VERSION_MINECRAFT}
echo World Name:   ${WORLD_NAME}
echo
echo Root Path:    ${PATH_OVERVIEWER_ROOT}
echo Scripts Path: ${PATH_OVERVIEWER_SCRIPT}
echo Worlds Path:  ${PATH_OVERVIEWER_WORLDS}
echo Overviewer:   ${PATH_OVERVIEWER_EXEC}
echo
echo Input:        ${PATH_OVERVIEWER_WORLD}
echo Ouput:        ${PATH_OVERVIEWER_OUTPUT}

if [ ! -d "~/.minecraft/versions/${VERSION_MINECRAFT}" ]
then
    mkdir -p ~/.minecraft/versions/${VERSION_MINECRAFT}
    wget https://overviewer.org/textures/${VERSION_MINECRAFT} -O ~/.minecraft/versions/${VERSION_MINECRAFT}/${VERSION_MINECRAFT}.jar
fi

mkdir -p ${PATH_OVERVIEWER_OUTPUT}

PATH_OVERVIEWER_WORLD=${PATH_OVERVIEWER_WORLD} PATH_OVERVIEWER_OUTPUT=${PATH_OVERVIEWER_OUTPUT} ${PATH_OVERVIEWER_EXEC} --config=${PATH_OVERVIEWER_ROOT}/render.conf
PATH_OVERVIEWER_WORLD=${PATH_OVERVIEWER_WORLD} PATH_OVERVIEWER_OUTPUT=${PATH_OVERVIEWER_OUTPUT} ${PATH_OVERVIEWER_EXEC} --config=${PATH_OVERVIEWER_ROOT}/render.conf --genpoi
